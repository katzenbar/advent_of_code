defmodule ExAdvent.Y2020.Day03Test do
  use ExUnit.Case

  import ExAdvent.Y2020.Day03

  test "parse input" do
    input = ~s"""
    ..##.......
    #...#...#..
    .#....#..#.
    ..#.#...#.#
    .#...##..#.
    ..#.##.....
    .#.#.#....#
    .#........#
    #.##...#...
    #...##....#
    .#..#...#.#
    """

    assert parse_input(input) == [
             '..##.......',
             '#...#...#..',
             '.#....#..#.',
             '..#.#...#.#',
             '.#...##..#.',
             '..#.##.....',
             '.#.#.#....#',
             '.#........#',
             '#.##...#...',
             '#...##....#',
             '.#..#...#.#'
           ]
  end

  test "traverse_with_slope" do
    map = [
      '..##.......',
      '#...#...#..',
      '.#....#..#.',
      '..#.#...#.#',
      '.#...##..#.',
      '..#.##.....',
      '.#.#.#....#',
      '.#........#',
      '#.##...#...',
      '#...##....#',
      '.#..#...#.#'
    ]

    assert traverse_with_slope(map, 1, 3) == '..#.##.####'
  end

  test "trees_encountered_with_slope" do
    map = [
      '..##.......',
      '#...#...#..',
      '.#....#..#.',
      '..#.#...#.#',
      '.#...##..#.',
      '..#.##.....',
      '.#.#.#....#',
      '.#........#',
      '#.##...#...',
      '#...##....#',
      '.#..#...#.#'
    ]

    assert trees_encountered_with_slope(map, 1, 3) == 7
  end

  test "trees_encountered_with_slopes" do
    map = [
      '..##.......',
      '#...#...#..',
      '.#....#..#.',
      '..#.#...#.#',
      '.#...##..#.',
      '..#.##.....',
      '.#.#.#....#',
      '.#........#',
      '#.##...#...',
      '#...##....#',
      '.#..#...#.#'
    ]

    slopes = [
      {1, 1},
      {1, 3},
      {1, 5},
      {1, 7},
      {2, 1}
    ]

    assert trees_encountered_with_slopes(map, slopes) == [2, 7, 3, 4, 2]
  end
end
